/*! \file
*               Author: mstewart
*   \brief      UID: Unique stm32 ID module
*/
/***************************************************************************************************
**                              Includes                                                          **
***************************************************************************************************/
#include <stdio.h>
#include <stdlib.h>

#include "STDC.h"
#include "C_defs.h"
#include "UID.h"



/***************************************************************************************************
**                              Data declarations and definitions                                 **
***************************************************************************************************/
UID_st UID_s;
 

/***************************************************************************************************
**                              Public Functions                                                  **
***************************************************************************************************/
/*!
****************************************************************************************************
*
*   \brief         Module (re-)initialisation function
*
*   \author        MS
*
*   \return        none
*
*   \note
*
***************************************************************************************************/
void UID_read_uinique_id( void )
{
	UID_s.uid0 = (*(u16_t*)UID_BASE_ADDRESS);
	UID_s.uid1 = (*(u16_t*)(UID_BASE_ADDRESS+2u));
	UID_s.uid2 = (*(u32_t*)(UID_BASE_ADDRESS+4u));
	UID_s.uid3 = (*(u32_t*)(UID_BASE_ADDRESS+8u));
}


/*!
****************************************************************************************************
*
*   \brief         Reads the lowest 8bits of the HW UID
*
*   \author        MS
*
*   \return        none
*
*   \note
*
***************************************************************************************************/
u8_t UID_get_unique_id_8( void )
{
	UID_read_uinique_id();

	return( UID_s.uid0 & 0xFF );
}


/*!
****************************************************************************************************
*
*   \brief         Reads the lowest 16bits of the HW UID
*
*   \author        MS
*
*   \return        none
*
*   \note
*
***************************************************************************************************/
u16_t UID_get_unique_id_16( void )
{
	UID_read_uinique_id();

	return( UID_s.uid0 );
}


/*!
****************************************************************************************************
*
*   \brief         Reads the lowest 32bits of the HW UID
*
*   \author        MS
*
*   \return        none
*
*   \note
*
***************************************************************************************************/
u32_t UID_get_unique_id_32( void )
{
	u32_t id;
	UID_read_uinique_id();

	id = UID_s.uid0;
	id |= ( ( UID_s.uid1 & 0x0000FFFF ) << 16u );

	return( id );
}


/***************************************************************************************************
**                              Private Functions                                                 **
***************************************************************************************************/


/****************************** END OF FILE *******************************************************/
